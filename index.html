<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="qs.css">
  <link rel="stylesheet" href="map.css">
  <style>
    body{
      max-width: 800px;
      margin-inline: auto;
    }
    .fig9{
      font-family: Helvetica, Arial;
      font-size: 14px;
      overflow: visible;
    }
    .fig9-legend{
      margin-left: 50%;
    }

  </style>
</head>
<body>






<div class="report-chart" id="fig9-image">
  <p class="title"><span>Figure 9</span> Provincial funding to school boards per-student, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig9.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig9">Accessible version</a></p>
</div>

<p>Ullamco adipisicing fugiat adipisicing aliqua Lorem laboris dolore anim culpa exercitation voluptate dolore deserunt. Laboris dolore et nulla magna laborum officia aliqua. Amet deserunt excepteur nulla pariatur. Non enim irure consectetur laborum aute elit et voluptate duis non cupidatat. Officia sint dolor do anim voluptate tempor irure laborum labore quis laborum labore et commodo. Anim nulla irure cupidatat ullamco. Qui ut consectetur consectetur ullamco amet consectetur veniam incididunt dolor non adipisicing adipisicing incididunt.</p>

<div class="report-chart" id="fig10-image">
  <p class="title"><span>Figure 10</span> Provincial per-student funding by school system, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig10.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig10">Accessible version</a></p>
</div>

<p>Cupidatat deserunt duis sunt magna incididunt nulla duis do do consectetur sunt ea. Velit incididunt pariatur non aliqua est amet aliqua cillum nostrud proident sit. Elit irure fugiat amet ullamco aliquip quis consectetur magna. Sunt irure laborum pariatur Lorem aute esse elit eu. Pariatur sunt officia veniam et cillum qui dolore qui ullamco consequat non.</p>

<div class="report-chart" id="fig11-image">
  <p class="title"><span>Figure 11</span> GSN funding per-student, by school board, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig11.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig11">Accessible version</a></p>
</div>
<h3>Remoteness and Urban Factor</h3> 

<p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ea ipsum, fugit magni cupiditate nihil similique fuga iste quisquam quaerat, voluptatibus quibusdam, eligendi perspiciatis. Animi dolorem nesciunt nisi a eligendi, nemo tempore, officia ratione ducimus molestias minima tempora commodi sapiente voluptatum nihil similique? Eaque, error aliquam vitae dignissimos rem mollitia hic sit voluptatibus veniam esse, magnam, a rerum animi quaerat nobis minima enim obcaecati. Totam est atque hic culpa a vitae libero doloremque asperiores animi illo praesentium, sequi explicabo consequatur qui magnam amet, nobis officia sed deserunt quisquam tenetur neque, possimus enim! Culpa, ratione repudiandae reiciendis illo suscipit aliquam esse?</p>

<h4>Enrolment and base funding</h4>

<p>Ad laboris consectetur mollit eiusmod aliqua tempor quis ex velit et cillum est amet eiusmod. Ipsum eu commodo velit officia dolore deserunt aliqua ad nisi. Ea officia consectetur voluptate tempor proident in incididunt sint. Voluptate irure ea ipsum eu occaecat aute eiusmod et. Excepteur deserunt duis mollit non cupidatat exercitation commodo voluptate consectetur laboris aute incididunt culpa. Ipsum aliqua incididunt veniam dolore magna ut aute.</p>

<div class="report-chart" id="fig12-image">
  <p class="title"><span>Figure 12:</span> School board size and per-student GSN funding, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig12.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig12">Accessible version</a></p>
</div>

<p>Nostrud sunt incididunt eiusmod pariatur aliqua eiusmod nulla excepteur duis labore magna mollit nulla dolor. Fugiat laborum consequat consequat in incididunt. Ea in qui aliqua ipsum duis nulla culpa aute ut minim nulla fugiat id. Eiusmod aliquip cupidatat magna irure in deserunt tempor aute ex in aliquip. Est non amet cillum veniam. Eu duis eu et Lorem duis exercitation irure tempor ullamco reprehenderit consectetur ea.</p>

<div class="report-chart" id="fig13-image">
  <p class="title"><span>Figure 13</span> School board dispersion and per-student GSN funding, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig12.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig13">Accessible version</a></p>
</div>

<p>Nulla reprehenderit laboris irure ad velit ex incididunt anim cupidatat. Nisi cupidatat Lorem esse incididunt id sunt do nisi enim proident Lorem irure. Enim cupidatat proident labore officia sint pariatur exercitation veniam nulla labore cupidatat. Adipisicing qui nulla cillum quis esse consectetur ad eiusmod commodo ipsum dolore.</p>

<div class="report-chart" id="fig14-image">
  <p class="title"><span>Figure 14</span> School board remoteness and per-student GSN funding, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig14.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig14">Accessible version</a></p>
</div>

<p>Ut amet ut quis occaecat mollit ipsum esse quis aliquip incididunt. Non excepteur est fugiat irure eu reprehenderit Lorem sint eu sit sint culpa. Do tempor amet deserunt qui. Ullamco amet Lorem eiusmod sunt labore et. Incididunt ad laborum ipsum aliquip. Ex consequat laborum occaecat incididunt velit in id.</p>


<div class="report-chart" id="fig15-image">
  <p class="title"><span>Figure 15</span> District School board remoteness and per student funding, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig15.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig15">Accessible version</a></p>
</div>

<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Harum amet exercitationem alias quis sunt quae iure aspernatur in. Modi, necessitatibus deleniti perspiciatis voluptatum voluptas pariatur earum cum cumque hic enim dolorum fugit dolore aperiam. Ab mollitia cupiditate tempore repellendus perferendis vero ex dicta iste. Fuga exercitationem quod iste blanditiis ratione! Architecto, fugit, odio accusantium illo eligendi ipsum nihil deleniti sapiente fuga voluptatum, ducimus quidem enim minima?</p>


<!--Fig 16-->
<div class="report-chart" id="fig16-image">
  <p class="title"><span>Figure 16:</span> Per-student GSN Language Grant funding by school board, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig16.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig16">Accessible version</a></p>
</div>

<h2>Priorities and Partnership Fund (PPF)</h2>

<p>Officia aute labore laboris ut tempor commodo ipsum elit. Do ullamco non aliqua occaecat dolor minim aliqua laboris laborum eu nulla. Nostrud tempor tempor ex incididunt sit. Mollit magna reprehenderit ullamco Lorem deserunt nulla ea nulla sunt eu. Elit magna reprehenderit amet fugiat consectetur ad magna adipisicing sint. Ex elit anim nisi duis ullamco sint reprehenderit occaecat.</p>

<div class="report-chart" id="fig17-image">
  <p class="title"><span>Figure 17:</span> Priorities and Partnership Fund per-student funding, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig17.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig17">Accessible version</a></p>
</div>

<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Magnam, molestiae saepe, voluptate culpa non sit odio ducimus fugit corporis consequatur, harum unde perferendis. Odit ipsa et modi. Saepe quibusdam voluptate id eveniet accusamus quos enim delectus eius, officiis totam modi placeat corporis possimus odio!</p>

<div class="report-chart" id="fig18-image">
  <p class="title"><span>Figure 18:</span> Priorities and Partnership Fund per-student allocations, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig18.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig18">Accessible version</a></p>
</div>

<p>Occaecat proident occaecat laborum et ut eiusmod adipisicing. Cupidatat culpa et proident officia exercitation. In eu ad dolor voluptate qui mollit ad ea ex irure pariatur. Dolor aliqua adipisicing mollit elit laborum tempor ad Lorem irure nulla aliqua cupidatat. Lorem sunt aute deserunt ut sit. Sit ea mollit dolor velit sunt ea reprehenderit exercitation consectetur laborum. Amet laborum minim ullamco dolore culpa.</p>

<div class="report-chart" id="fig19-image">
  <p class="title"><span>Figure 19:</span> Official Languages Projects program per-student funding, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig19.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig19">Accessible version</a></p>
</div>

<p>Ullamco Lorem in nisi cillum. Est ea est mollit esse amet pariatur tempor pariatur tempor consequat. Reprehenderit et commodo proident elit tempor ad cillum Lorem occaecat culpa nulla in. Lorem quis occaecat reprehenderit cupidatat. Enim veniam dolore ipsum sit et eiusmod adipisicing cupidatat voluptate ullamco in sunt est aliquip.</p>

<div class="report-chart" id="fig33-image">
  <p class="title"><span>Figure 33:</span> Priorities and Partnership Fund per-student allocations, by school board, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig32.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig33">Accessible version</a></p>
</div>

<p>Ullamco Lorem in nisi cillum. Est ea est mollit esse amet pariatur tempor pariatur tempor consequat. Reprehenderit et commodo proident elit tempor ad cillum Lorem occaecat culpa nulla in. Lorem quis occaecat reprehenderit cupidatat. Enim veniam dolore ipsum sit et eiusmod adipisicing cupidatat voluptate ullamco in sunt est aliquip.</p>

<div class="report-chart" id="fig36-image">
  <p class="title"><span>Figure 36:</span> EQAO pass rate vs. per-student funding, by school board, 2021-2022 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig19.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig36">Accessible version</a></p>
</div>





<!-- load library -->
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6"></script>

<script type="module">
  const fao_blue = '#0f60d5';
  const fao_white = '#ffffff';
  const fao_dark_blue = '#1a2b4a';
  const fao_light_blue_1 = '#9ec2f5';
  const fao_light_blue_2 = '#bad1f6';
  const fao_light_blue_3 = '#d7e4fa';
  const fao_light_blue_4 = '#f1f6fd';
  const fao_green = '#b2d235';
  const fao_pink = '#e23e94';



  // load data from CSV
  d3.csv("master_board.csv").then( d => {
    console.log(d);

    // FIG  9 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    const fig_9 = Plot.plot({
                    width: 800,
                    padding: 0.3,
                    className: "fig9",
                    //center the plot
                    x:{label: "School Board", nice: true,
                        tickFormat: d => null,
                    },
                    y:{label: "Per Student Funding", nice: true, domain:[0,40000]},
                    marks: [
                        Plot.barY(d, 
                            {x: "Board", y: "Per-student Funding ($)", 
                            fill: "System", 
                            /*
                            tip: true,
                            */
                            channels:{'Per-student Funding ($)': "Per-student Funding ($)"},
                            sort: {x: "Per-student Funding ($)"}}),
                        
                        //Plot a line that indicates the average
                        Plot.ruleY([13364], {stroke: "black", strokeDasharray: "4,4", weight: 4}),
                        //sit above the line
                        Plot.text(["Average: 13,364"], {y: 14000, dy: -10, dx: -300, textAnchor: "start", fontWeight: "bold", fontSize: 12, text: d => d}),
                        
                        Plot.tip(d, Plot.pointerX({
                          x: "Board",
                          y: "Per-student Funding ($)",
                          lineWidth: 1000,
                          //anchor: "bottom"
                          //make
                        })),
                        
                        
                    ],
                    
                    color:{
                        legend:true,
                        //center the legend
                        domain:['English Public','English Catholic','French Public','French Catholic'],
                        range:['#1060D5','#90B7F2','#E43D96','#E6C7D8'],
                        marginLeft: 150
                    }
                });
    const fig_9_div = document.querySelector("#fig9-image img");
    fig_9_div.after(fig_9);


    // FIG 10 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    let fig_10_data = [{'System' : 'English Public', 'Grants for Student Needs' : 12409, 'Priorities and Partnership Fund': 615, 'Official Languages Project': 4, 'Total Funding': 13027},
    {'System' : 'English Catholic', 'Grants for Student Needs' : 12559, 'Priorities and Partnership Fund': 687, 'Official Languages Project': 6, 'Total Funding': 13252},
    {'System' : 'French Public', 'Grants for Student Needs' : 17468, 'Priorities and Partnership Fund': 1001, 'Official Languages Project': 117, 'Total Funding': 18585},
    {'System' : 'French Catholic', 'Grants for Student Needs' : 16655, 'Priorities and Partnership Fund': 890, 'Official Languages Project': 135, 'Total Funding': 13027},
    {'System' : 'Average', 'Grants for Student Needs' : 12701, 'Priorities and Partnership Fund': 652, 'Official Languages Project': 11, 'Total Funding': 13364}]

    //switch to tidy data format
    let tidy = fig_10_data.flatMap(d => Object.keys(d).slice(1).map(k => ({System: d.System, Program: k, Value: d[k], Total: d['Total Funding']})));
    //remove Total Funding from the list of programs
    tidy = tidy.filter(d => d.Program != 'Total Funding');
    //console.log(tidy)
    //let tidy = fig_10_data.columns.slice(1).flatMap(k => fig_10_data.map(d => ({System: d.System, Program: k, Value: d[k]})));

    const fig_10 = Plot.plot({
      padding: 0.6,
      width: 800,
      className: "fig9",
      y: {domain:[0,20000]},
      x: {label: "School System", domain: ["English Public", "English Catholic", "French Public", "French Catholic", "Average"]},
      color: {legend: true, domain: ["Grants for Student Needs", "Priorities and Partnership Fund", "Official Languages Project"], range: ["#1060D5", "#90B7F2", "#B2D235"], marginLeft: 130},
      marks: [
        Plot.barY(tidy, {x: "System", y: "Value",  fill: "Program", tip: true}),
        Plot.ruleY([0]),
        Plot.ruleX(["French Catholic"], {stroke: "black", strokeDasharray: "4,4", weight: 4, dx: 70, dy: 15}),
        Plot.text(["13,027"], {y: 13600, dx: -264}),
        Plot.text(["13,252"], {y: 13750, dx: -130}),
        Plot.text(["18,585"], {y: 19100, dx: 1}),
        Plot.text(["17,680"], {y: 18200, dx: 134}),
        Plot.text(["13,364"], {y: 13800, dx: 265})
      ]
    })
    const fig_10_div = document.querySelector("#fig10-image img");
    fig_10_div.after(fig_10);
    
    

    // FIG 12 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    const fig_12 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      x: {label: "School Board", nice: true, tickFormat: d => null},
      y: {label: "Per Student Funding ($)", nice: true, domain: [0, 35000]},
      marks:[
        Plot.barY(d,{
          x: "Board",
          y: "Per-student Funding ($)",
          tip: true,
          fill: "Size",
          channels: {"Per-student Funding ($)": "Per-student Funding ($)"},
          sort: {x: "Per-student Funding ($)"},
        }),
        Plot.ruleY([12701], {stroke: "black", strokeDasharray: "6,6", weight: 1}),

      ],
      color:{legend: true, domain: ["Small", "Medium", "Large"], range: ["#93BBF7", "#1060D5", "#E23C94"], marginLeft: 250},

    })
    const fig_12_div = document.querySelector("#fig12-image img");
    fig_12_div.after(fig_12);
    
    // FIG 13 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    const fig_13 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y: {label: "Per Student Funding ($)", nice: true, domain: [0, 35000]},
      marks:[
        Plot.barY(d,{
          x: "Board",
          y: "Per-student Funding ($)",
          fill: "Dispersion",
          tip: true,
          channels: {"Per-student Funding ($)": "Per-student Funding ($)"},
          sort: {x: "Per-student Funding ($)"}
        }),
        Plot.ruleY([12701], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
      ],
      color: {legend: true, domain: ["Least Disperse", "Medium Disperse", "Most Disperse"], range: ["#93BBF7", "#1060D5", "#E23C94"], marginLeft: 180}
    })
    const fig_13_div = document.querySelector("#fig13-image img");
    fig_13_div.after(fig_13);
    
    // FIG 14 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    const fig_14 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      x:{label: "School Board", nice: true, tickFormat: d => null},
      marks:[
        Plot.barY(d, {
          x: "Board",
          y: "Per-student Funding ($)",
          tip: true,
          fill: "Remote",
          channels: {"Per-student Funding ($)": "Per-student Funding ($)"},
          sort: {x: "Per-student Funding ($)"}
        })
      ],
      color: {legend: true, domain: ["Least Remote", "Medium Remote", "Most Remote"], range: ["#93BBF7", "#1060D5", "#E23C94"], marginLeft: 180}
    })
    const fig_14_div = document.querySelector("#fig14-image img");
    fig_14_div.after(fig_14);
    
    // FIG 15 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    const fig_15 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y:{label: "Per Student Funding ($)", nice: true, domain: [0, 35000]},
      marks: [
        Plot.barY(d, {
          x: "Board", 
          y: "Per-student Funding ($)",
          tip: true,
          fill: "Urban",
          channels: {"Per-student Funding ($)": "Per-student Funding ($)"},
          sort: {x: "Per-student Funding ($)"},
        })
      ],
      color: {legend: true, domain: ["Rural", "Leans Rural", "Leans Urban", "Urban"], range: ["#E43D96", "#FAD8EA", "#93BBF7", "#1060D5"], marginLeft: 180}
    })
    const fig_15_div = document.querySelector("#fig15-image img");
    fig_15_div.after(fig_15);
    

    // FIG 17 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    d3.csv("fig17_data.csv").then(d => {
      let fig17_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Funding": +d[k], System: k})));
      fig17_tidy = fig17_tidy.filter(d => d.System != 'Average');
      for(let i = 0; i < fig17_tidy.length; i++){
        //if the per student funding is "" then remove it
        if(fig17_tidy[i]["Per Student Funding"] == 0){
          fig17_tidy.splice(i, 1);
          i--;
        }
      }
      console.log(fig17_tidy);
      const fig_17 = Plot.plot({
        width: 800,
        padding: 0.3,
        className: "fig9",
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 4500], label: "Per Student Funding", nice: true},
        marks: [
          Plot.barY(fig17_tidy, {
            x: "Board", 
            y: "Per Student Funding", 
            fill: 'System', 
            tip: true,
            title: (d) => "School Board: " + `${d.Board},  "\nSchool System:" ${d.System}` + "\nPer Student Funding: " + `${d["Per Student Funding"]}`,
            channels: {'Per Student Funding': 'Per Student Funding'},
            sort: {x: "Per Student Funding"}
          }),
        ],
        color: {legend: true, domain: ["English Public", "English Catholic", "French Public", "French Catholic"], range: ["#1060D5", "#90B7F2", "#E43D96", "#E6C7D8"], marginLeft: 150}
      });
      const fig_17_div = document.querySelector("#fig17-image img");
      fig_17_div.after(fig_17);
    })

    //FIG 18 / / / / / / / / / /
    // Stacked
    d3.csv("fig18_data.csv").then(d => {
    let fig18_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Funding": d[k], Allocation: k, Total: d['Total']})));
    for(let i = 0; i < fig18_tidy.length; i++){
      //cast each Per Student Funding to a number
      fig18_tidy[i]["Total"] = +fig18_tidy[i]["Total"];
      //if the per student funding is "" then remove it
      if(fig18_tidy[i]["Per Student Funding"] == ""){
        fig18_tidy.splice(i, 1);
        i--;
      }
    }
    //filter out Average
    fig18_tidy = fig18_tidy.filter(d => d.Allocation != 'Average' && d.Allocation != 'Total');
    //remove Total and Average from Grant
    console.log(fig18_tidy);
    const fig_18 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y:{domain: [0, 4500], label: "Per Student Funding", nice: true},
      marks: [
        Plot.barY(fig18_tidy, {
          x: "Board", 
          y: "Per Student Funding", 
          fill: 'Allocation', 
          tip: true,
          channels: {'Total': 'Total'},
          sort: {x: "Total"}
        }),
      ],
    });
    const fig_18_div = document.querySelector("#fig18-image img");
    fig_18_div.after(fig_18);
    })
    
    // FIG 19 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    d3.csv("fig19_data.csv").then(d=>{
    let fig19_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Funding": d[k], Language: k})));
    //get rid of duplicate boards
    for(let i = 0; i < fig19_tidy.length; i++){
      //cast each Per Student Funding to a number
      fig19_tidy[i]["Per Student Funding"] = +fig19_tidy[i]["Per Student Funding"];
      //if the per student funding is "" then remove it
      if(fig19_tidy[i]["Per Student Funding"] == ""){
        fig19_tidy.splice(i, 1);
        i--;
      }
    }
    console.log(fig19_tidy);
    const fig_19 =
      Plot.plot({
        width: 800,
        padding: 0.3,
        className: "fig9",
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 600], label: "Per Student Funding", nice: true},
        marks:[
          Plot.barY(fig19_tidy, {
            x: "Board",
            y: "Per Student Funding",
            fill: "Language",
            channels: {"Per Student Funding": "Per Student Funding"},
            sort: {x: "Per Student Funding"},
            tip: true,
          }),
        ]
      })
    const fig_19_div = document.querySelector("#fig19-image img");
    fig_19_div.after(fig_19);
    })

    
    // FIG 20 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    
    // FIG 23 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    
    // FIG 27 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    
    // FIG 29 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    
    // FIG 32 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    
    // FIG 33 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    //let fig_33_d have the eqao pass rate as a percentage (so multiply the value by 100)
    let fig_33_d = d.map(d => ({Board: d.Board, "EQAO Pass Rate": d["EQAO Pass Rate"]*100, System: d.System}));
    const fig_33 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y:{label: "EQAO Pass Rate", nice: true, domain: [0, 100]},
      marks: [
        Plot.barY(fig_33_d, {
          x: "Board",
          y: "EQAO Pass Rate",
          fill: "System",
          tip: true,
          channels: {"EQAO Pass Rate": "EQAO Pass Rate"},
          sort: {x: "EQAO Pass Rate"}
        }),
        Plot.ruleY([67.7], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 67.7%"], {y: 70, dx: -50}),  
      ],
      color: {legend: true, domain: ["English Public", "English Catholic", "French Public", "French Catholic"], range: ["#1060D5", "#90B7F2", "#E43D96", "#E6C7D8"], marginLeft: 150}
    })

    const fig_33_div = document.querySelector("#fig33-image img");
    fig_33_div.after(fig_33);
    
    // FIG 35 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart


    // FIG 36 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // scatter plot
    const fig_36 = Plot.plot({
      marks:[
        Plot.dot(d, {
          x: "Per Student Funding ($)",
          y: "EQAO Pass Rate",
          fill: "Board",
        })
      ]
    })
    const fig_36_div = document.querySelector("#fig36-image img");
    fig_36_div.after(fig_36);

  })

  //Figure 11
  d3.csv("fig11_data.csv").then(d =>{
      console.log(d);
      let fig11_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, Grant: k, Value: d[k], Total: d['Total']})));
      //remove Total and Average from Grant
      fig11_tidy = fig11_tidy.filter(d => d.Grant != 'Total' && d.Grant != 'Average');
      console.log(fig11_tidy);
      const fig_11 = Plot.plot({
        width: 800,
        padding: 0.3,
        className: "fig9",
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 35000], label: "Per Student Funding", nice: true},
        marks: [
          Plot.barY(fig11_tidy, {
            x: "Board", 
            y: "Value", 
            fill: 'Grant', 
            tip: true,
            channels: {'Total': 'Total'},
            sort: {x: "Total"}
          }),
        ],
        color: {legend: true, domain: ["Pupil Foundation Grant", "Special Education Grant", "Geographic Circumstances Grant", "Language Grant", "All Other Grants"], range: ["#1060D5", "#E43D96", "#B2D235","#93BBF7","#BFBFBF"], marginLeft: 0}
      });
      const fig_11_div = document.querySelector("#fig11-image img");
      fig_11_div.after(fig_11);
  })


  //figure 16
  d3.csv("fig16_data.csv").then(d =>{
      let fig16_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Funding": d[k], Language: k})));
      //filter out Average
      fig16_tidy = fig16_tidy.filter(d => d.Language != ' Average ');
      //remove Total and Average from Grant
      const fig_16 = Plot.plot({
        width: 800,
        padding: 0.3,
        className: "fig9",
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 35000], label: "Per Student Funding", nice: true},
        marks: [
          Plot.barY(fig16_tidy, {
            x: "Board", 
            y: "Per Student Funding", 
            fill: 'Language', 
            tip: true,
            channels: {'Per Student Funding': 'Per Student Funding'},
            sort: {x: "Per Student Funding"}
          }),
        ],
        color: {legend: true, domain:["English-language School Board", "French-language School Board"], range: ["#1060D5", "#E43D96"], marginLeft: 150}
      });
      const fig_16_div = document.querySelector("#fig16-image img");
      fig_16_div.after(fig_16);
  })

  //FIG 18 STACKED, cant figure out why its not sorting


  //FIG 19


    
    


</script>










</body>
</html>