<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="qs.css">
  <link rel="stylesheet" href="map.css">
  <style>
    body{
      max-width: 800px;
      margin-inline: auto;
    }
    figure {
      margin:0;
    }

    figure title{
      font-weight: bold;
    }
    .fig9{
      font-family: Helvetica, Arial;
      font-size: 14px;
      overflow: visible;
      margin: 0;
      margin-bottom: 15px;
    }
    .fig-legend-swatch{
      font-size: 13px;
      font-family: Helvetica, Arial;
    }
    g[aria-label="bar"]:has(rect:hover) rect:not(:hover){
      fill:#00000011;
    }
    g[aria-label="y-axis label"] text{
      font-size: 14px;
    }
    g[aria-label="x-axis label"]{
      font-size: 14px;
      /*add a bit of space between the axis label and the axis*/
      transform: translateY(36px);
    }
    g[aria-label="text"] text{
      font-size: 13px;
    }

    .fig9-swatch{
      font-size: 13px;
      font-family: Helvetica, Arial;
    }

    g[aria-label="dot"]:has(circle:hover) circle:not(:hover){
      fill:#ccc;
    }

    g[aria-label="text"] text{
      font-size: 14px;
      font-family: Helvetica, Arial;
    }

  </style>
</head>
<body>






<div class="report-chart" id="fig9-image">
  <p class="title"><span>Figure 9</span> Provincial funding to school boards per-student, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig9.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig9">Accessible version</a></p>
</div>

<p>Ullamco adipisicing fugiat adipisicing aliqua Lorem laboris dolore anim culpa exercitation voluptate dolore deserunt. Laboris dolore et nulla magna laborum officia aliqua. Amet deserunt excepteur nulla pariatur. Non enim irure consectetur laborum aute elit et voluptate duis non cupidatat. Officia sint dolor do anim voluptate tempor irure laborum labore quis laborum labore et commodo. Anim nulla irure cupidatat ullamco. Qui ut consectetur consectetur ullamco amet consectetur veniam incididunt dolor non adipisicing adipisicing incididunt.</p>

<div class="report-chart" id="fig10-image">
  <p class="title"><span>Figure 10</span> Provincial per-student funding by school system, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig10.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig10">Accessible version</a></p>
</div>

<p>Cupidatat deserunt duis sunt magna incididunt nulla duis do do consectetur sunt ea. Velit incididunt pariatur non aliqua est amet aliqua cillum nostrud proident sit. Elit irure fugiat amet ullamco aliquip quis consectetur magna. Sunt irure laborum pariatur Lorem aute esse elit eu. Pariatur sunt officia veniam et cillum qui dolore qui ullamco consequat non.</p>

<div class="report-chart" id="fig11-image">
  <p class="title"><span>Figure 11</span> GSN funding per-student, by school board, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig11.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig11">Accessible version</a></p>
</div>
<h3>Remoteness and Urban Factor</h3> 

<p>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ea ipsum, fugit magni cupiditate nihil similique fuga iste quisquam quaerat, voluptatibus quibusdam, eligendi perspiciatis. Animi dolorem nesciunt nisi a eligendi, nemo tempore, officia ratione ducimus molestias minima tempora commodi sapiente voluptatum nihil similique? Eaque, error aliquam vitae dignissimos rem mollitia hic sit voluptatibus veniam esse, magnam, a rerum animi quaerat nobis minima enim obcaecati. Totam est atque hic culpa a vitae libero doloremque asperiores animi illo praesentium, sequi explicabo consequatur qui magnam amet, nobis officia sed deserunt quisquam tenetur neque, possimus enim! Culpa, ratione repudiandae reiciendis illo suscipit aliquam esse?</p>

<h4>Enrolment and base funding</h4>

<p>Ad laboris consectetur mollit eiusmod aliqua tempor quis ex velit et cillum est amet eiusmod. Ipsum eu commodo velit officia dolore deserunt aliqua ad nisi. Ea officia consectetur voluptate tempor proident in incididunt sint. Voluptate irure ea ipsum eu occaecat aute eiusmod et. Excepteur deserunt duis mollit non cupidatat exercitation commodo voluptate consectetur laboris aute incididunt culpa. Ipsum aliqua incididunt veniam dolore magna ut aute.</p>

<div class="report-chart" id="fig12-image">
  <p class="title"><span>Figure 12:</span> School board size and per-student GSN funding, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig12.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig12">Accessible version</a></p>
</div>

<p>Nostrud sunt incididunt eiusmod pariatur aliqua eiusmod nulla excepteur duis labore magna mollit nulla dolor. Fugiat laborum consequat consequat in incididunt. Ea in qui aliqua ipsum duis nulla culpa aute ut minim nulla fugiat id. Eiusmod aliquip cupidatat magna irure in deserunt tempor aute ex in aliquip. Est non amet cillum veniam. Eu duis eu et Lorem duis exercitation irure tempor ullamco reprehenderit consectetur ea.</p>

<div class="report-chart" id="fig13-image">
  <p class="title"><span>Figure 13</span> School board dispersion and per-student GSN funding, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig12.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig13">Accessible version</a></p>
</div>

<p>Nulla reprehenderit laboris irure ad velit ex incididunt anim cupidatat. Nisi cupidatat Lorem esse incididunt id sunt do nisi enim proident Lorem irure. Enim cupidatat proident labore officia sint pariatur exercitation veniam nulla labore cupidatat. Adipisicing qui nulla cillum quis esse consectetur ad eiusmod commodo ipsum dolore.</p>

<div class="report-chart" id="fig14-image">
  <p class="title"><span>Figure 14</span> School board remoteness and per-student GSN funding, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig14.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig14">Accessible version</a></p>
</div>

<p>Ut amet ut quis occaecat mollit ipsum esse quis aliquip incididunt. Non excepteur est fugiat irure eu reprehenderit Lorem sint eu sit sint culpa. Do tempor amet deserunt qui. Ullamco amet Lorem eiusmod sunt labore et. Incididunt ad laborum ipsum aliquip. Ex consequat laborum occaecat incididunt velit in id.</p>


<div class="report-chart" id="fig15-image">
  <p class="title"><span>Figure 15</span> District School board remoteness and per student funding, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig15.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig15">Accessible version</a></p>
</div>

<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Harum amet exercitationem alias quis sunt quae iure aspernatur in. Modi, necessitatibus deleniti perspiciatis voluptatum voluptas pariatur earum cum cumque hic enim dolorum fugit dolore aperiam. Ab mollitia cupiditate tempore repellendus perferendis vero ex dicta iste. Fuga exercitationem quod iste blanditiis ratione! Architecto, fugit, odio accusantium illo eligendi ipsum nihil deleniti sapiente fuga voluptatum, ducimus quidem enim minima?</p>


<!--Fig 16-->
<div class="report-chart" id="fig16-image">
  <p class="title"><span>Figure 16:</span> Per-student GSN Language Grant funding by school board, 2021-22 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig16.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig16">Accessible version</a></p>
</div>

<h2>Priorities and Partnership Fund (PPF)</h2>

<p>Officia aute labore laboris ut tempor commodo ipsum elit. Do ullamco non aliqua occaecat dolor minim aliqua laboris laborum eu nulla. Nostrud tempor tempor ex incididunt sit. Mollit magna reprehenderit ullamco Lorem deserunt nulla ea nulla sunt eu. Elit magna reprehenderit amet fugiat consectetur ad magna adipisicing sint. Ex elit anim nisi duis ullamco sint reprehenderit occaecat.</p>

<div class="report-chart" id="fig17-image">
  <p class="title"><span>Figure 17:</span> Priorities and Partnership Fund per-student funding, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig17.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig17">Accessible version</a></p>
</div>

<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Magnam, molestiae saepe, voluptate culpa non sit odio ducimus fugit corporis consequatur, harum unde perferendis. Odit ipsa et modi. Saepe quibusdam voluptate id eveniet accusamus quos enim delectus eius, officiis totam modi placeat corporis possimus odio!</p>

<div class="report-chart" id="fig18-image">
  <p class="title"><span>Figure 18:</span> Priorities and Partnership Fund per-student allocations, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig18.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig18">Accessible version</a></p>
</div>

<p>Occaecat proident occaecat laborum et ut eiusmod adipisicing. Cupidatat culpa et proident officia exercitation. In eu ad dolor voluptate qui mollit ad ea ex irure pariatur. Dolor aliqua adipisicing mollit elit laborum tempor ad Lorem irure nulla aliqua cupidatat. Lorem sunt aute deserunt ut sit. Sit ea mollit dolor velit sunt ea reprehenderit exercitation consectetur laborum. Amet laborum minim ullamco dolore culpa.</p>

<div class="report-chart" id="fig19-image">
  <p class="title"><span>Figure 19:</span> Official Languages Projects program per-student funding, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig19.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig19">Accessible version</a></p>
</div>

<p>Ullamco Lorem in nisi cillum. Est ea est mollit esse amet pariatur tempor pariatur tempor consequat. Reprehenderit et commodo proident elit tempor ad cillum Lorem occaecat culpa nulla in. Lorem quis occaecat reprehenderit cupidatat. Enim veniam dolore ipsum sit et eiusmod adipisicing cupidatat voluptate ullamco in sunt est aliquip.</p>

<div class="report-chart" id="fig22-image">
  <p class="title"><span>Figure 22:</span> Revenue per-student, by school board and source, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig22.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig22">Accessible version</a></p>
</div>

<p>Nisi eu et aute proident est. Est deserunt aliquip magna esse laboris duis nisi. Consectetur elit duis eiusmod fugiat aliquip laborum eiusmod. In laboris duis nisi dolore ipsum in magna. Sit id aliquip laborum adipisicing aliqua. Eu ut reprehenderit amet fugiat ullamco ex dolor cupidatat nostrud. Sit irure sunt ea consequat occaecat magna aute non officia magna est eiusmod.</p>

<div class="report-chart" id="fig26-image">
  <p class="title"><span>Figure 26:</span>  Spending per-student, by school board, 2021-22 school year, dollars</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig26.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig26">Accessible version</a></p>
</div>

<p>Proident irure mollit aute eiusmod aliqua quis tempor. Esse id aliqua laboris incididunt consectetur sit veniam. Non veniam officia do veniam fugiat officia tempor sit Lorem.</p>

<div class="report-chart" id="fig29-image">
  <p class="title"><span>Figure 29:</span>   School boards' budget balance as a share of revenue, 2021-22 school year, per cent</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig29.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig29">Accessible version</a></p>
</div>

<p>Mollit est elit quis labore ut. Sunt nulla sunt consectetur dolor eiusmod anim est veniam. Minim dolor eu anim consequat sunt laborum eu sunt sunt labore. Est tempor in Lorem cupidatat do ipsum ut sunt et sunt velit ipsum.</p>

<div class="report-chart" id="fig31-image">
  <p class="title"><span>Figure 31:</span>School boardsâ€™ accumulated surplus / (deficit) as a share of 2021-22 revenue, as of August 31, 2022, per cent</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig31.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: 2021-22 school board financial statements and FAO analysis of information provided by the Province.</p>
  <p class="alt-text-link"><a href="#fig31">Accessible version</a></p>
</div>


<p>Eu commodo ad exercitation dolor nostrud. Sunt laboris incididunt occaecat ad eiusmod. Nisi nostrud ut cupidatat cillum Lorem. Amet duis et officia non consectetur enim anim amet incididunt voluptate laboris qui velit magna. Tempor id aliquip irure anim id eu pariatur. Officia nostrud deserunt Lorem pariatur cupidatat aute.</p>

<div class="report-chart" id="fig34-image">
  <p class="title"><span>Figure 34:</span> EQAO average pass rate by school board, 2021-2022 school year, per cent</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig32.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig34">Accessible version</a></p>
</div>

<p>Ullamco Lorem in nisi cillum. Est ea est mollit esse amet pariatur tempor pariatur tempor consequat. Reprehenderit et commodo proident elit tempor ad cillum Lorem occaecat culpa nulla in. Lorem quis occaecat reprehenderit cupidatat. Enim veniam dolore ipsum sit et eiusmod adipisicing cupidatat voluptate ullamco in sunt est aliquip.</p>

<div class="report-chart" id="fig36-image">
  <p class="title"><span>Figure 36:</span> Average EQAO pass rate by school board and urban factor, 2021-2022 school year, per cent</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig36.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig36">Accessible version</a></p>
</div>

<p>Commodo tempor aliqua ipsum officia fugiat eiusmod est. Lorem esse reprehenderit elit reprehenderit amet occaecat dolore cillum. Aute ut veniam occaecat cillum enim sunt anim excepteur in quis ullamco commodo incididunt nulla. Ullamco voluptate irure excepteur ex esse sunt mollit ex aliqua mollit sunt aliquip aute. Ullamco duis velit anim cillum nisi non cupidatat est veniam laboris. Do voluptate id Lorem anim aute occaecat qui reprehenderit laborum est officia.</p>

<div class="report-chart" id="fig37-image">
  <p class="title"><span>Figure 37:</span> EQAO pass rate vs. per-student funding, by school board, 2021-2022 school year</p>
  <img src="/web/default/files/publications/FA2207%20School%20Board%20Funding/fig19.png" style="width: 100%; max-width: 100%;" />
  <p class="source">Source: Public Accounts of Ontario, 2023 Ontario Budget, and FAO analysis of information provided by the Province</p>
  <p class="alt-text-link"><a href="#fig37">Accessible version</a></p>
</div>





<!-- load library -->
<script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
<script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.6"></script>

<script type="module">
  const fao_blue = '#0f60d5';
  const white = '#ffffff';
  const fao_dark_blue = '#1a2b4a';
  const fao_light_blue_1 = '#9ec2f5';
  const fao_light_blue_2 = '#bad1f6';
  const fao_light_blue_3 = '#d7e4fa';
  const fao_light_blue_4 = '#f1f6fd';
  const fao_green = '#b2d235';
  const fao_pink = '#e23e94';
  const fao_light_pink = "#E6C7D8";

  function replaceFig(figId,graphElement){
    const img = document.querySelector('#' + figId + '-image img');
    img.after(graphElement);
    img.style.display = "none";

  }

  // load data from CSV
  d3.csv("master_board.csv").then( d => {
    console.log(d);

    // FIG  9 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    const fig_9 = Plot.plot({
                    width: 800,
                    padding: 0.3,
                    className: "fig9",
                    marginLeft: 75,
                    //center the plot
                    x:{label: "School Board", nice: true,
                        tickFormat: d => null,
                    },
                    y:{label: "Per Student Funding ($)", nice: true, domain:[0,40000]},
                    marks: [
                        Plot.barY(d, 
                            {x: "Board", y: "Per-student Funding ($)", 
                            fill: "System", 
                            /*
                            tip: true,
                            */
                            channels:{'Per-student Funding ($)': "Per-student Funding ($)"},
                            sort: {x: "Per-student Funding ($)"},
                            stroke: white,
                            strokeWidth: 3,
                            strokeOpacity: 0,
                          }),
                        
                        //Plot a line that indicates the average
                        Plot.ruleY([13364], {stroke: "black", strokeDasharray: "4,4", weight: 4}),
                        //sit above the line
                        Plot.text(["Average, 13,364"], {y: 14000, dy: -10, dx: -300, textAnchor: "start",  fontSize: 12, text: d => d}),
                        
                        Plot.tip(d, Plot.pointerX({
                          x: "Board",
                          y: "Per-student Funding ($)",
                          title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d["Per-student Funding ($)"])}` + "\nSystem: " + `${d.System}`,
                          lineWidth: 1000,
                          //anchor: "bottom"
                          //make
                        })),
                        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
                        
                        
                    ],
                    
                    color:{
                        legend:true,
                        //center the legend
                        domain:['English Public','English Catholic','French Public','French Catholic'],
                        range:['#1060D5','#90B7F2','#E43D96','#E6C7D8'],
                        marginLeft: 150,
                        className : "fig-legend",
                    }
                });
    // const fig_9_div = document.querySelector("#fig9-image img");
    // fig_9_div.after(fig_9);
    replaceFig("fig9",fig_9)


    // FIG 10 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    let fig_10_data = [{'System' : 'English Public', 'Grants for Student Needs' : 12409, 'Priorities and Partnership Fund': 615, 'Official Languages Project': 4, 'Total Funding': 13027},
    {'System' : 'English Catholic', 'Grants for Student Needs' : 12559, 'Priorities and Partnership Fund': 687, 'Official Languages Project': 6, 'Total Funding': 13252},
    {'System' : 'French Public', 'Grants for Student Needs' : 17468, 'Priorities and Partnership Fund': 1001, 'Official Languages Project': 117, 'Total Funding': 18585},
    {'System' : 'French Catholic', 'Grants for Student Needs' : 16655, 'Priorities and Partnership Fund': 890, 'Official Languages Project': 135, 'Total Funding': 13027},
    {'System' : 'Average', 'Grants for Student Needs' : 12701, 'Priorities and Partnership Fund': 652, 'Official Languages Project': 11, 'Total Funding': 13364}]

    //switch to tidy data format
    let tidy = fig_10_data.flatMap(d => Object.keys(d).slice(1).map(k => ({System: d.System, Program: k, Value: d[k], Total: d['Total Funding']})));
    //remove Total Funding from the list of programs
    tidy = tidy.filter(d => d.Program != 'Total Funding');
    //console.log(tidy)
    //let tidy = fig_10_data.columns.slice(1).flatMap(k => fig_10_data.map(d => ({System: d.System, Program: k, Value: d[k]})));

    const fig_10 = Plot.plot({
      padding: 0.6,
      width: 800,
      className: "fig9",
      marginLeft: 75,
      y: {domain:[0,20000], label: "Per Student Funding ($)"},
      x: {label: "", domain: ["English Public", "English Catholic", "French Public", "French Catholic", "Average"]},
      color: {legend: true, domain: ["Grants for Student Needs", "Priorities and Partnership Fund", "Official Languages Project"], range: ["#1060D5", "#90B7F2", "#B2D235"], marginLeft: 130},
      marks: [
        Plot.barY(tidy, {
          x: "System", 
          y: "Value",  
          fill: "Program", 
          tip: true,  
          title: (d) => "School System: " + `${d.System}` + "\nGrant Program: " + `${d.Program}` + "\nPer Student Funding: " + "$" + `${d.Value}`,     
          stroke: white,
          strokeWidth: 2,
          strokeOpacity: 0,
        }),
        Plot.ruleY([0]),
        Plot.ruleX(["French Catholic"], {stroke: "black", strokeDasharray: "4,4", weight: 4, dx: 70, dy: 15}),
        Plot.text(["13,027"], {y: 13600, dx: -250}),
        Plot.text(["13,252"], {y: 13750, dx: -125}),
        Plot.text(["18,585"], {y: 19100, dx: 1}),
        Plot.text(["17,680"], {y: 18200, dx: 125}),
        Plot.text(["13,364"], {y: 13800, dx: 250}),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ]
    })
    const fig_10_div = document.querySelector("#fig10-image img");
    fig_10_div.after(fig_10);
    
    

    // FIG 12 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    const fig_12 = Plot.plot({
      width: 800,
      padding: 0.3,
      marginLeft: 75,
      className: "fig9",
      x: {label: "School Board", nice: true, tickFormat: d => null},
      y: {label: "Per Student Funding ($)", nice: true, domain: [0, 35000]},
      marks:[
        Plot.barY(d,{
          x: "Board",
          y: "Per-student Funding ($)",
          //tip: true,
          fill: "Size",
          channels: {"Per-student Funding ($)": "Per-student Funding ($)"},
          sort: {x: "Per-student Funding ($)"},
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
        }),
        Plot.ruleY([12701], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 12,701"], {y: 13950, dx: -150}),
        Plot.tip(d, Plot.pointerX({
          x: "Board",
          y: "Per-student Funding ($)",
          title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d["Per-student Funding ($)"])}` + "\nSize: " + `${d.Size}`,
          lineWidth: 1000,
          //anchor: "bottom"
          //make
        })),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ],
      color:{legend: true, domain: ["Small", "Medium", "Large"], range: ["#93BBF7", "#1060D5", "#E23C94"], marginLeft: 300},

    })
    const fig_12_div = document.querySelector("#fig12-image img");
    fig_12_div.after(fig_12);
    
    // FIG 13 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    const fig_13 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      marginLeft: 75,
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y: {label: "Per Student Funding ($)", nice: true, domain: [0, 35000]},
      marks:[
        Plot.barY(d,{
          x: "Board",
          y: "Per-student Funding ($)",
          fill: "Dispersion",
          channels: {"Per-student Funding ($)": "Per-student Funding ($)"},
          sort: {x: "Per-student Funding ($)"},
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
        }),
        Plot.ruleY([12701], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 12,701"], {y: 13950, dx: -150}),
        Plot.tip(d, Plot.pointerX({
          x: "Board",
          y: "Per-student Funding ($)",
          title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d["Per-student Funding ($)"])}` + "\nDispersion: " + `${d.Dispersion}`,
          lineWidth: 1000,
          //anchor: "bottom"
          //make
        })),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ],
      color: {legend: true, domain: ["Least Disperse", "Medium Disperse", "Most Disperse"], range: ["#93BBF7", "#1060D5", "#E23C94"], marginLeft: 230}
    })
    const fig_13_div = document.querySelector("#fig13-image img");
    fig_13_div.after(fig_13);
    
    // FIG 14 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    const fig_14 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      marginLeft: 75,
      x:{label: "School Board", nice: true, tickFormat: d => null},
      marks:[
        Plot.barY(d, {
          x: "Board",
          y: "Per-student Funding ($)",
          tip: true,
          title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + `${d["Per-student Funding ($)"]}` + "\nRemoteness: " + `${d.Remote}`,
          fill: "Remote",
          channels: {"Per-student Funding ($)": "Per-student Funding ($)"},
          sort: {x: "Per-student Funding ($)"},
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
        }),
        Plot.ruleY([12701], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 12,701"], {y: 13950, dx: -150}),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ],
      color: {legend: true, domain: ["Least Remote", "Medium Remote", "Most Remote"], range: ["#93BBF7", "#1060D5", "#E23C94"], marginLeft: 230}
    })
    const fig_14_div = document.querySelector("#fig14-image img");
    fig_14_div.after(fig_14);
    
    // FIG 15 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    const fig_15 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      marginLeft: 75,
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y:{label: "Per Student Funding ($)", nice: true, domain: [0, 35000]},
      marks: [
        Plot.barY(d, {
          x: "Board", 
          y: "Per-student Funding ($)",
          //tip: true,
          //title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + `${d["Per-student Funding ($)"]}`,
          fill: "Urban",
          channels: {"Per-student Funding ($)": "Per-student Funding ($)"},
          sort: {x: "Per-student Funding ($)"},
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
        }),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
        Plot.ruleY([12701], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 12,701"], {y: 13950, dx: -150}),
        Plot.tip(d, Plot.pointerX({
          x: "Board",
          y: "Per-student Funding ($)",
          title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d["Per-student Funding ($)"])}` + "\nUrban Factor: " + `${d.Urban}`,
          lineWidth: 1000,
          //anchor: "bottom"
          //make
        })),
      ],
      color: {legend: true, domain: ["Rural", "Leans Rural", "Leans Urban", "Urban"], range: ["#E43D96", "#FAD8EA", "#93BBF7", "#1060D5"], marginLeft: 230}
    })
    const fig_15_div = document.querySelector("#fig15-image img");
    fig_15_div.after(fig_15);
    

    // FIG 17 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    d3.csv("fig17_data.csv").then(d => {
      let fig17_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Funding": +d[k], System: k})));
      fig17_tidy = fig17_tidy.filter(d => d.System != 'Average');
      for(let i = 0; i < fig17_tidy.length; i++){
        //if the per student funding is "" then remove it
        if(fig17_tidy[i]["Per Student Funding"] == 0){
          fig17_tidy.splice(i, 1);
          i--;
        }
      }
      console.log(fig17_tidy);
      const fig_17 = Plot.plot({
        width: 800,
        padding: 0.3,
        marginLeft: 75,
        className: "fig9",
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 4500], label: "Per Student Funding ($)", nice: true},
        marks: [
          Plot.barY(fig17_tidy, {
            x: "Board", 
            y: "Per Student Funding", 
            fill: 'System', 
            //tip: true,
            //title: (d) => "School Board: " + `${d.Board},  "\nSchool System:" ${d.System}` + "\nPer Student Funding: " + `${d["Per Student Funding"]}`,
            channels: {'Per Student Funding': 'Per Student Funding'},
            sort: {x: "Per Student Funding"},
            stroke: white,
            strokeWidth: 3,
            strokeOpacity: 0,
          }),
          Plot.ruleY([652], {stroke: "black", strokeDasharray: "4,4", weight: 4}),
          Plot.text(["Average, 652"], {y: 700, dx: -200, dy: -10, textAnchor: "start",  fontSize: 12, text: d => d}),
          Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
          Plot.tip(fig17_tidy, Plot.pointerX({
            x: "Board",
            y: "Per Student Funding",
            title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d["Per Student Funding"])}` + "\nSystem: " + `${d.System}`,
            lineWidth: 1000,
            //anchor: "bottom"
            //make
          })),
        ],
        color: {legend: true, domain: ["English Public", "English Catholic", "French Public", "French Catholic"], range: ["#1060D5", "#90B7F2", "#E43D96", "#E6C7D8"], marginLeft: 150}
      });
      const fig_17_div = document.querySelector("#fig17-image img");
      fig_17_div.after(fig_17);
    })

    //FIG 18 / / / / / / / / / /
    // Stacked
    d3.csv("fig18_data.csv").then(d => {
      let fig18_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Funding": d[k], Allocation: k, Total: d['Total']})));
      for(let i = 0; i < fig18_tidy.length; i++){
        //cast each Per Student Funding to a number
        fig18_tidy[i]["Total"] = +fig18_tidy[i]["Total"];
        //if the per student funding is "" then remove it
        if(fig18_tidy[i]["Per Student Funding"] == ""){
          fig18_tidy.splice(i, 1);
          i--;
        }
      }
      //filter out Average
      fig18_tidy = fig18_tidy.filter(d => d.Allocation != 'Average' && d.Allocation != 'Total');
      //remove Total and Average from Grant
      console.log(fig18_tidy);
      const fig_18 = Plot.plot({
        width: 800,
        padding: 0.3,
        className: "fig9",
        marginLeft: 75,
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 4500], label: "Per Student Funding ($)", nice: true},
        marks: [
          Plot.barY(fig18_tidy, {
            x: "Board", 
            y: "Per Student Funding", 
            fill: 'Allocation', 
            tip: true,
            title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d["Per Student Funding"])}` + "\nAllocation: " + `${d.Allocation}`,
            channels: {'Total': 'Total'},
            sort: {x: "Total"},
            stroke: white,
            strokeWidth: 3,
            strokeOpacity: 0,
          }),
          Plot.ruleY([652], {stroke: "black", strokeDasharray: "4,4", weight: 4}),
          Plot.text(["Average, 652"], {y: 700, dx: -200, dy: -10, textAnchor: "start",  fontSize: 12, text: d => d}),
          Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
        ],
        color: {legend: true, domain: ["COVID-related", "Tutoring Supports", "Reading Supports & Assessments", "All Other"], range: [fao_blue, fao_light_blue_1, fao_pink, fao_light_blue_2], marginLeft: 150}
      });
      const fig_18_div = document.querySelector("#fig18-image img");
      fig_18_div.after(fig_18);
    })
    
    // FIG 19 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    d3.csv("fig19_data.csv").then(d=>{
      let fig19_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Funding": d[k], Language: k})));
      //get rid of duplicate boards
      for(let i = 0; i < fig19_tidy.length; i++){
        //cast each Per Student Funding to a number
        fig19_tidy[i]["Per Student Funding"] = +fig19_tidy[i]["Per Student Funding"];
        //if the per student funding is "" then remove it
        if(fig19_tidy[i]["Per Student Funding"] == ""){
          fig19_tidy.splice(i, 1);
          i--;
        }
      }
      console.log(fig19_tidy);
      const fig_19 =
        Plot.plot({
          width: 800,
          padding: 0.3,
          className: "fig9",
          marginLeft: 75,
          x:{label: "School Board", nice: true, tickFormat: d => null},
          y:{domain: [0, 600], label: "Per Student Funding ($)", nice: true},
          marks:[
            Plot.barY(fig19_tidy, {
              x: "Board",
              y: "Per Student Funding",
              fill: "Language",
              channels: {"Per Student Funding": "Per Student Funding"},
              sort: {x: "Per Student Funding"},
              //tip: true,
              //title: (d) => "School Board: " + `${d.Board},  "\nSchool Board Language:" ${d.Language}` + "\nPer Student Funding: " + `${d["Per Student Funding"]}`,
              stroke: white,
              strokeWidth: 3,
              strokeOpacity: 0,
            }),
            Plot.tip(fig19_tidy, Plot.pointerX({
              x: "Board",
              y: "Per Student Funding",
              title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d["Per Student Funding"])}` + "\nSchool Board Type: " + `${d.Language}`,
              lineWidth: 1000,
              //anchor: "bottom"
              //make
            })),
            Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
          ],
          color: {legend: true, domain: ["English-language School Board", "French-language School Board"], range: [fao_blue, fao_pink], marginLeft: 150}
        })
      const fig_19_div = document.querySelector("#fig19-image img");
      fig_19_div.after(fig_19);
    })

    
    // FIG 22 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    d3.csv("fig22_data.csv").then(d => {
      let fig22_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Revenue": +d[k], System: k})));
      fig22_tidy = fig22_tidy.filter(d => d.System != 'Average');
      console.log(fig22_tidy);
      const fig_22 = Plot.plot({
        width: 800,
        padding: 0.3,
        marginLeft: 75,
        className: "fig9",
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 45000], label: "Per Student Revenue ($)", nice: true},
        marks: [
          Plot.barY(fig22_tidy, {
            x: "Board", 
            y: "Per Student Revenue", 
            fill: 'System', 
            tip: true,
            title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Revenue: " + "$" + `${Math.round(d["Per Student Revenue"])}` + "\nSystem: " + `${d.System}`,
            channels: {'Per Student Revenue': 'Per Student Revenue'},
            sort: {x: "Per Student Revenue"},
            stroke: white,
            strokeWidth: 3,
            strokeOpacity: 0,
          }),
          Plot.ruleY([14501], {stroke: "black", strokeDasharray: "4,4", weight: 4}),
          Plot.text(["Average, 14,501"], {y: 15500, dx: -200}),
          Plot.axisY({ labelAnchor: "center", labelArrow: "none",  })
        ],
        color: {legend: true, domain: ["Provincial and Own Source Operating Revenue", "Revenue for Infrastructure Projects", "Federal Transfers Revenue"], range: [fao_light_blue_1, fao_pink, fao_blue], marginLeft: 50, className: "fig-legend", width: 900}
      });
      const fig_22_div = document.querySelector("#fig22-image img");
      fig_22_div.after(fig_22);
    })

    
    // FIG 26 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    const fig_26 = Plot.plot({
      width: 800,
      padding: 0.3,
      marginLeft: 75,
      className: "fig9",
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y:{label: "Per Student Spending ($)", nice: true, domain: [0, 45000]},
      marks:[
        Plot.barY(d,{
          x: "Board",
          y: "Per-student Spending ($)",
          fill: "System",
          tip: true,
          title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Spending: " + "$" + `${Math.round(d["Per-student Spending ($)"])}` + "\nSchool Board Type: " + `${d.System}`,
          channels: {"Per-student Spending ($)": "Per-student Spending ($)"},
          sort: {x: "Per-student Spending ($)"},
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
        }),
        Plot.ruleY([14426], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 14,426"], {y: 15500, dx: -200}),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ],
      color: {legend: true, domain: ["English Public", "English Catholic", "French Public", "French Catholic"], range: [fao_blue, fao_light_blue_1, fao_pink, fao_light_pink], marginLeft: 170},
    })
    const fig_26_div = document.querySelector("#fig26-image img");
    fig_26_div.after(fig_26);
    
    // FIG 29 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    let fig_29_data = d.map(d => ({Board: d.Board, "Surplus as Share of Revenue": +d["Surplus as Share of Revenue"], System: d.System}));

    const fig_29 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      marginLeft: 75,
      x:{label: "School Board", nice: true, tickFormat: d => null},
      //add percent to the Y axis
      y:{percent: true, domain:[-4, 6], label: "Surplus as Share of Revenue (%)", tickFormat: d => d + "%"},
      marks:[
        Plot.barY(fig_29_data,{
          x: "Board",
          y: "Surplus as Share of Revenue",
          fill: "System",
          tip: true,
          title: (d) => "School Board: " + `${d.Board}` + "\nSurplus as Share of Revenue: " + `${Math.round((+d["Surplus as Share of Revenue"]*100) * 100) / 100}` + "%\nSchool Board Type: " + `${d.System}`,
          channels: {"Surplus as Share of Revenue": "Surplus as Share of Revenue"},
          sort: {x: "Surplus as Share of Revenue"},
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
        }),
        Plot.ruleY([0.005], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 0.5%"], {y: 0.008, dx: -230}),
        //make the X axis start as 0 and be dashed
        //Plot.ruleY([0], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ],
      color:{legend: true, domain: ["English Public", "English Catholic", "French Public", "French Catholic"], range: [fao_blue, fao_light_blue_1, fao_pink, fao_light_pink], marginLeft: 170}
    })
    const fig_29_div = document.querySelector("#fig29-image img");
    fig_29_div.after(fig_29);
    
    // FIG 31 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    let fig_31_data = d.map(d => ({Board: d.Board, "Year-End Accumulated Surplus as Share of Revenue (August 31, 2022)": d["Year-End Accumulated Surplus as Share of Revenue (August 31, 2022)"]*100, System: d.System}));
    const fig_31 = Plot.plot({
      width: 800,
      padding: 0.3,
      className: "fig9",
      marginLeft: 75,
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y:{domain: [-10, 90], label: "Year-End Accumulated Surplus as Share of Expenses", tickFormat: d => d + "%"},
      marks:[
        Plot.barY(fig_31_data,{
          x: "Board",
          y: "Year-End Accumulated Surplus as Share of Revenue (August 31, 2022)",
          fill: "System",
          tip: true,
          channels: {"Year-End Accumulated Surplus as Share of Revenue (August 31, 2022)": "Year-End Accumulated Surplus as Share of Revenue (August 31, 2022)"},
          sort: {x: "Year-End Accumulated Surplus as Share of Revenue (August 31, 2022)"},
          title: (d) => "School Board: " + `${d.Board},` + "\nSchool System: " + `${d.System},` + "\nYear-End Accumulated Surplus as Share of Revenue: " + `${Math.round(+d["Year-End Accumulated Surplus as Share of Revenue (August 31, 2022)"]*100)/100}`,
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
        }),
        Plot.ruleY([22.6], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 22.6%"], {y: 26.5, dx: -180}),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ],
      color: {legend: true, domain: ["English Public", "English Catholic", "French Public", "French Catholic"], range: [fao_blue, fao_light_blue_1, fao_pink, fao_light_pink], marginLeft: 170}
      //color:{legend: true, domain: ["Small", "Medium", "Large"], range: [fao_blue, fao_light_blue_1, fao_pink], marginLeft: 250}
    })
    const fig_31_div = document.querySelector("#fig31-image img");
    fig_31_div.after(fig_31);
    
    // FIG 34 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart
    //let fig_33_d have the eqao pass rate as a percentage (so multiply the value by 100)
    let fig_34_d = d.map(d => ({Board: d.Board, "EQAO Pass Rate": d["EQAO Pass Rate"]*100, System: d.System}));
    const fig_34 = Plot.plot({
      width: 800,
      padding: 0.3,
      marginLeft: 75,
      className: "fig9",
      x:{label: "School Board", nice: true, tickFormat: d => null},
      y:{label: "EQAO Pass Rate (%)", nice: true, domain: [0, 100], tickFormat: d => d + "%"},
      marks: [
        Plot.barY(fig_34_d, {
          x: "Board",
          y: "EQAO Pass Rate",
          fill: "System",
          tip: true,
          channels: {"EQAO Pass Rate": "EQAO Pass Rate"},
          sort: {x: "EQAO Pass Rate"},
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
          title: (d) => "School Board: " + `${d.Board},` + "\nSchool System: " + `${d.System},` + "\nEQAO Pass Rate: " + `${Math.round(+d["EQAO Pass Rate"]*100)/100}`,
        }),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
        Plot.ruleY([67.7], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 67.7%"], {y: 70, dx: -50}),  
      ],
      color: {legend: true, domain: ["English Public", "English Catholic", "French Public", "French Catholic"], range: ["#1060D5", "#90B7F2", "#E43D96", "#E6C7D8"], marginLeft: 180}
    })

    const fig_34_div = document.querySelector("#fig34-image img");
    fig_34_div.after(fig_34);
    
    // FIG 36 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // bar chart

    const fig_36 = Plot.plot({
      width: 800,
      padding: 0.3,
      className : "fig9",
      marginLeft: 75,
      y:{percent: true, label: "EQAO Pass Rate (%)",domain:[0, 100]},
      x:{label: "School Board", nice: true, tickFormat: d => null},
      marks:[
        Plot.barY(d,{
          x: "Board",
          y: "EQAO Pass Rate",
          fill: "Urban",
          tip: true,
          title: (d) => "School Board: " + `${d.Board}` + "\nEQAO Pass Rate: " + `${Math.round(((+d["EQAO Pass Rate"]*100)*100))/100}` + "%\nUrban Factor: " + `${d.Urban}`,
          channels: {"EQAO Pass Rate": "EQAO Pass Rate"},
          sort: {x: "EQAO Pass Rate"},
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 0,
        }),
        Plot.ruleY([.677], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average, 67.7%"], {y: .70, dx: -30}),  
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ],
      color: {legend: true, domain: ["Rural", "Leans Rural", "Leans Urban", "Urban"], range: ["#E43D96", "#FAD8EA", "#93BBF7", "#1060D5"], marginLeft: 250}
    })
    const fig_36_div = document.querySelector("#fig36-image img");
    fig_36_div.after(fig_36);


    // FIG 37 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
    // scatter plot
    let fig_37_data = d.map(d => ({Board: d.Board, "EQAO Pass Rate": +d["EQAO Pass Rate"]*100, "Per Student Funding": +d["Per-student Funding ($)"]}));
    const fig_37 = Plot.plot({
      width: 800,
      padding: 0.3,
      marginLeft: 75,
      className: "fig9",
      y:{domain:[40, 85], fy: 5, label: "EQAO Pass Rate (%)"},
      x:{domain:[10000,40000]},
      marks:[
        Plot.dot(fig_37_data, {
          x: "Per Student Funding",
          y: "EQAO Pass Rate",
          tip: true,
          title: (d) => "School Board: " + `${d.Board}` + "\nEQAO Pass Rate: " + `${Math.round((+d["EQAO Pass Rate"]*100))/100}` + "%\nPer Student Funding: " + "$" + `${Math.round(d["Per Student Funding"])}`,
          fill: "#1060D5",
          channels: {"EQAO Pass Rate": "EQAO Pass Rate", "Per Student Funding": "Per Student Funding"},
          sort: {x: "Per Student Funding"},
          r: 5.5,
          stroke: white,
          strokeWidth: 3,
          strokeOpacity: 1,
        }),
        Plot.ruleX([13364], {stroke: "blue", strokeDasharray: "6,6", weight: 1}),
        Plot.ruleY([67.7], {stroke: "blue", strokeDasharray: "6,6", weight: 1}),
        Plot.text(["Average pass \nrate 67.7%"], {y: 70, dx: 350}),
        Plot.text(["Average per \nstudent funding \n$13,364"], {y: 82, dx: -220}),
        Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
      ],
    })
    const fig_37_div = document.querySelector("#fig37-image img");
    fig_37_div.after(fig_37);

  })

  //Figure 11
  d3.csv("fig11_data.csv").then(d =>{
      console.log(d);
      let fig11_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, Grant: k, Value: d[k], Total: d['Total']})));
      //remove Total and Average from Grant
      fig11_tidy = fig11_tidy.filter(d => d.Grant != 'Total' && d.Grant != 'Average');
      console.log(fig11_tidy);
      const fig_11 = Plot.plot({
        width: 800,
        padding: 0.3,
        // className: "fig9",
        marginLeft: 75,
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 35000], label: "Per Student Funding ($)", nice: true},
        marks: [
          Plot.barY(fig11_tidy, {
            x: "Board", 
            y: "Value", 
            fill: 'Grant', 
            tip: true,
            title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d.Value)}` + "\nGrant: " + `${d.Grant}`,
            channels: {'Total': 'Total'},
            sort: {x: "Total"},
            stroke: white,
            strokeWidth: 3,
            strokeOpacity: 0,
          }),
          Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
        ],
        color: {legend: true, domain: ["Pupil Foundation Grant", "Special Education Grant", "Geographic Circumstances Grant", "Language Grant", "All Other Grants"], range: ["#1060D5", "#E43D96", "#B2D235","#93BBF7","#BFBFBF"]}
      });
      const fig_11_div = document.querySelector("#fig11-image img");
      fig_11_div.after(fig_11);
  })


  //figure 16
  d3.csv("fig16_data.csv").then(d =>{
      let fig16_tidy = d.flatMap(d => Object.keys(d).slice(1).map(k => ({Board: d.Board, "Per Student Funding": d[k], Language: k})));
      //filter out Average
      fig16_tidy = fig16_tidy.filter(d => d.Language != ' Average ');
      //remove Total and Average from Grant
      const fig_16 = Plot.plot({
        width: 800,
        padding: 0.3,
        className: "fig9",
        marginLeft: 75,
        x:{label: "School Board", nice: true, tickFormat: d => null},
        y:{domain: [0, 35000], label: "Per Student Funding ($)", nice: true},
        marks: [
          Plot.barY(fig16_tidy, {
            x: "Board", 
            y: "Per Student Funding", 
            fill: 'Language', 
            tip: true,
            title: (d) => "School Board: " + `${d.Board}` + "\nPer Student Funding: " + "$" + `${Math.round(d["Per Student Funding"])}` + "\nSchool Board Type: " + `${d.Language}`,
            channels: {'Per Student Funding': 'Per Student Funding'},
            sort: {x: "Per Student Funding"},
            stroke: white,
            strokeWidth: 3,
            strokeOpacity: 0,
            r: 5.5,
          }),
          Plot.ruleY([12701], {stroke: "black", strokeDasharray: "6,6", weight: 1}),
          Plot.text(["Average, 12,701"], {y: 13950, dx: -150}),
          Plot.axisY({ labelAnchor: "center", labelArrow: "none",  }),
        ],
        color: {legend: true, domain:["English-language School Board", "French-language School Board"], range: ["#1060D5", "#E43D96"], marginLeft: 180}
      });
      const fig_16_div = document.querySelector("#fig16-image img");
      fig_16_div.after(fig_16);
  })

</script>










</body>
</html>